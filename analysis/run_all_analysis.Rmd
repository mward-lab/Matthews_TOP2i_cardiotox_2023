---
title: "Run_all_analysis"
author: "ERM"
date: "`r Sys.Date()`"
output: html_document:
    toc: yes
    theme: flatly
editor_options: 
  markdown: 
    wrap: 72
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = FALSE,
	message = FALSE,
	warning = FALSE
)
```

This starts the documentation of the RNA-seq cardiotoxicity analysis for my manuscript
```{r library loading, warning=FALSE, echo=TRUE, message=FALSE}

library(edgeR)#
library(limma)#
library(RColorBrewer)
library(mixOmics)
library(gridExtra)#
library(reshape2)#
library(devtools)
library(AnnotationHub)
library(tidyverse)
library(scales)
library(biomaRt)#
library(Homo.sapiens)
library(cowplot)#
library(ggrepel)#
library(corrplot)
library(Hmisc)


```


```{r functions for graphs, warning=FALSE, echo=FALSE, message=FALSE}}

x_axis_labels=function(labels,every_nth=1,...) {
    axis(side=1,at=seq_along(labels),labels=F)
    text(x=(seq_along(labels))[seq_len(every_nth)==1],
        y=par("usr")[3]-0.075*(par("usr")[4]-par("usr")[3]),
        labels=labels[seq_len(every_nth)==1],xpd=TRUE,...)
}
```



```{r file loading, eval=TRUE, include=FALSE}

design <- read.csv("data/data_outline.txt", row.names = 1)
mymatrix <- readRDS("data/allmatrix.RDS")

##below only done once
#myfiles <- list.files(path = "~/Ward Lab/Cardiotoxicity/Data/counts/counts", pattern ="*.txt")
# mymatrix <- readDGE(files = myfiles, path = "~/Ward Lab/Cardiotoxicity/Data/counts/counts/", group =as.factor(rep((c("1","2","3","4","5","6","7","8","9","10","11","12")),6)))
# 
# saveRDS(mymatrix, "data/allmatrix.RDS")
```


